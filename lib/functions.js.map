{"version":3,"file":"functions.js","sources":["../src/functions.ts"],"sourcesContent":["import { z } from 'zod';\nimport { entitySchema } from './schemas';\nimport type { Not, VSO } from './types/dso';\nimport { Entity, WithEntity } from './types/entities';\n\nexport function isSearchOperation(val: any): val is VSO {\n  return Object.keys(val).every(val => val.startsWith('$'));\n}\n\nexport function isNotClause<T = any>(value: any): value is Not<T> {\n  return Object.keys(value)[0] === '$not';\n}\n\nexport function includesMany<T>(array: T[], includes: T[]) {\n  return includes.every(include => array.includes(include));\n}\n\ntype IsEntityT<Z extends z.ZodRawShape> = WithEntity<\n  z.infer<z.ZodObject<Z>>\n>;\n\nexport function isEntity<Z extends []>(\n  value: any,\n  ...args: Z\n): value is Entity;\n\nexport function isEntity<Z extends [shape: z.ZodRawShape]>(\n  value: any,\n  ...args: Z\n): value is IsEntityT<Z[0]>;\n\nexport function isEntity<Z extends [shape: z.ZodRawShape] | []>(\n  value: any,\n  ...[shape]: Z\n) {\n  if (shape) {\n    return entitySchema(shape).safeParse(value).success;\n  }\n  return entitySchema().safeParse(value).success;\n}\n\nconst tto = {};\nconst ttest = isEntity(tto);\n\nif (ttest) {\n  tto._id;\n}\n\nconst ttest2 = isEntity(tto, { login: z.string() });\nif (ttest2) {\n  tto.login;\n}\n"],"names":[],"mappings":";;;;AAKM,SAAU,iBAAiB,CAAC,GAAQ,EAAA;IACxC,OAAO,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,GAAG,IAAI,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC;AAC5D,CAAC;AAEK,SAAU,WAAW,CAAU,KAAU,EAAA;IAC7C,OAAO,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,MAAM,CAAC;AAC1C,CAAC;AAEe,SAAA,YAAY,CAAI,KAAU,EAAE,QAAa,EAAA;AACvD,IAAA,OAAO,QAAQ,CAAC,KAAK,CAAC,OAAO,IAAI,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC;AAC5D,CAAC;AAgBK,SAAU,QAAQ,CACtB,KAAU,EACV,GAAG,CAAC,KAAK,CAAI,EAAA;IAEb,IAAI,KAAK,EAAE;QACT,OAAO,YAAY,CAAC,KAAK,CAAC,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC;KACrD;IACD,OAAO,YAAY,EAAE,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC;AACjD,CAAC;AAED,MAAM,GAAG,GAAG,EAAE,CAAC;AACf,MAAM,KAAK,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAC;AAE5B,IAAI,KAAK,EAAE;IACT,GAAG,CAAC,GAAG,CAAC;AACV,CAAC;AAED,MAAM,MAAM,GAAG,QAAQ,CAAC,GAAG,EAAE,EAAE,KAAK,EAAE,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;AACpD,IAAI,MAAM,EAAE;IACV,GAAG,CAAC,KAAK,CAAC;AACZ;;;;"}